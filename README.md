# Sum-of-Exponentials-Approximation
This repository records both the weights and exponents of the SOE produced by the [VPMR](https://link.springer.com/article/10.1007/s10915-022-01999-1), a recently developed sum-of-exponentials method.

##  Gaussian kernel  ##
### Exponents and weights of the SOE for the Gaussian kernel  $f(x)=e^{-\frac{x^2}{4}}$ on $[0,\infty]$, with the number of terms $P=9$ and absolute error $10^{-8}$. ###

![Gaussian_9_terms_1e-8_error](https://github.com/LiangJiuyang/Sum-of-Exponentials-Approximation/tree/main/Screenshots/Gaussian_1e8_9term.png) 

### Exponents and weights of the SOE for the Gaussian kernel  $f(x)=e^{-\frac{x^2}{4}}$ on $[0,\infty]$, with the number of terms $P=16$ and absolute error $6\times 10^{-14}$. ###

![Gaussian_15_terms_6e-14_error](https://github.com/LiangJiuyang/Sum-of-Exponentials-Approximation/tree/main/Screenshots/Gaussian_6e14_15term.png) 

### Exponents and weights of the SOE for the Gaussian kernel $f(x)=e^{-x^2}$ on $[0,\infty]$, with the number of terms $P=18$ and absolute error $1\times 10^{-15}$. ###

**Weights**:
```
5.99673832958228e-06 + 1.68666706190233e-06i	5.99673832964075e-06 - 1.68666706179742e-06i	-0.00128256763349392 - 5.69515998682304e-05i	-0.00128256763349477 + 5.69515998663800e-05i	0.0467989716657016 - 0.0248428082769860i	0.0467989716657026 + 0.0248428082770166i	-0.335267028777594 + 0.757075111679156i	-0.335267028777571 - 0.757075111679353i	-1.99598682670183 - 5.99221164256010i	-1.99598682670221 + 5.99221164256101i	23.9009795446709 + 12.0862363354612i	23.9009795446732 - 12.0862363354632i	-64.0632116678656 + 22.5380203666186i	-64.0632116678705 - 22.5380203666172i	42.9479635779022 - 98.1965284307393i	42.9479635779079 + 98.1965284307392i	2.77886417555933e-16 + 1.05052462423441e-16i	2.77886412307273e-16 - 1.05052680588430e-16i
```
**Exponents**:
```
4.56160429581067 + 8.10664614462486i	4.56160429581067 - 8.10664614462486i	4.67614751620509 + 6.66817205403247i	4.67614751620509 - 6.66817205403247i	4.75706771210077 + 5.46277771275372i	4.75706771210077 - 5.46277771275372i	4.81739468471801 + 4.37139574323745i	4.81739468471801 - 4.37139574323745i	4.86201933938979 + 3.34750236244862i	4.86201933938979 - 3.34750236244862i	4.89345823682377 + 2.36588612738340i	4.89345823682377 - 2.36588612738340i	4.91338156910332 + 1.41021110952036i	4.91338156910332 - 1.41021110952036i	4.92300187934591 + 0.468589313154398i	4.92300187934591 - 0.468589313154398i	0.0334524767879181 + 0.0245907245253121i	0.0334524767879181 - 0.0245907245253121i
```

### Exponents and weights of the SOE for the Ewald splitting kernel $f(x)=\frac{\text{erf}(0.07*x)}{x}$ on $[10,\infty]$, with the number of terms $P=15$ and absolute error $1\times 10^{-5}$. ###

**Weights**:
```
-0.0123217913962719 + 0.00657629047346944i	-0.0123217913962719 - 0.00657629047346942i	0.0698188800549830 - 1.84234194892697e-20i	0.0220862075987946 + 9.91431757219100e-18i	0.00769880025029751 - 2.23316337487801e-18i	0.00270900012842870 - 1.21059093013288e-18i	0.00100525883881037 + 1.49105265468497e-18i	4.52266075457327e-07 - 7.71699732569162e-08i	4.52266075457358e-07 + 7.71699732569282e-08i	1.58142496623186e-06 - 2.90640237339666e-06i	1.58142496623189e-06 + 2.90640237339682e-06i	3.03269489685249e-06 - 3.42959635172713e-05i	3.03269489685250e-06 + 3.42959635172714e-05i	0.000324148962373470 - 2.08449779797628e-18i	-7.57527186239702e-07 - 4.26039052340300e-20i
```
**Exponents**:
```
0.127872670882671 - 0.120293871745525i	0.127872670882671 + 0.120293871745525i	0.0614956193889337 - 9.82164254748179e-20i	0.0208865892767227 - 7.06545189090522e-20i	0.00725476756606347 - 1.05377106249633e-19i	0.00248202211599808 + 1.69613391734418e-19i	0.000779376742917233 + 1.11622459120483e-19i	4.45007719991736e-05 - 0.000462442182313778i	4.45007719991731e-05 + 0.000462442182313778i	6.60643217233065e-05 - 0.000285597218951556i	6.60643217233065e-05 + 0.000285597218951556i	8.67769824332190e-05 - 0.000129693842951374i	8.67769824332188e-05 + 0.000129693842951374i	0.000106906515038133 + 6.67448518916536e-20i	2.82447271485155e-05 + 7.74453682029659e-22i
```

This configuration is commonly employed in molecular simulations to calculate long-range Coulombic interactions. It involves a cutoff radius $r_c=1$ $nm$, which limits the interactions to atoms within this distance. To handle the long-range interactions, the Ewald splitting method is used with an $\alpha$ value of $\sqrt{\alpha}=0.07$. The error level is about $10^{-4}$ for the simulation.

### Exponents and weights of the SOE for the Ewald splitting kernel $f(x)=\frac{\text{erf}(0.07*x)}{x}$ on $[10,\infty]$, with the number of terms $P=25$ and absolute error $1\times 10^{-6}$. ###

**Weights**:
```
-0.00529296242468516 + 0.00474905020180962i	-0.00529296242468516 - 0.00474905020180962i	-0.0912071464148451 + 8.46491454250240e-17i	0.121692030536638 - 9.16506186537911e-17i	0.0342360351688043 - 5.51661099183310e-18i	0.0142186855667854 - 9.79894684090327e-18i	0.00610410480168200 + 7.32709244483383e-18i	0.00268412836559151 + 1.13974632654299e-17i	1.71954083453806e-10 + 1.90136722488177e-09i	1.71954083446766e-10 - 1.90136722488386e-09i	0.00128948247585151 - 9.26213201223653e-18i	3.70267663867862e-08 + 4.13573700153938e-08i	3.70267663868377e-08 - 4.13573700153842e-08i	1.51880015152163e-07 + 3.18209627338474e-07i	1.51880015152142e-07 - 3.18209627338381e-07i	3.33980756279983e-07 + 1.53244923150026e-06i	3.33980756279931e-07 - 1.53244923150004e-06i	3.71805061354279e-08 + 6.19331174586060e-06i	3.71805061348446e-08 - 6.19331174586098e-06i	-2.70848878138637e-06 + 2.53066579667626e-05i	-2.70848878138785e-06 - 2.53066579667640e-05i	1.91823545866348e-05 + 0.000119040749462808i	1.91823545866390e-05 - 0.000119040749462811i	0.000504953139140243 + 2.97990799783149e-18i	-8.13882377283486e-06 - 4.20095241436021e-19i
```
**Exponents**:
```
0.158018063984209 + 0.165728131740132i	0.158018063984209 - 0.165728131740132i	0.152060468292075 + 3.47909856977216e-19i	0.101159492122542 - 9.46508226030632e-21i	0.0393950482545612 + 1.24743907305608e-19i	0.0167368112404094 + 9.88899479843878e-20i	0.00715408225855693 - 1.65081404475042e-19i	0.00300441094129008 + 4.34977934402860e-19i	7.01331120196959e-06 + 0.00147414633658650i	7.01331120197028e-06 - 0.00147414633658650i	0.00112668980925186 - 6.22690833492013e-19i	5.36355806487878e-05 + 0.000938383647688940i	5.36355806487869e-05 - 0.000938383647688938i	7.57376123508616e-05 + 0.000756586212449542i	7.57376123508623e-05 - 0.000756586212449541i	9.18703502433190e-05 + 0.000583347421343242i	9.18703502433189e-05 - 0.000583347421343241i	0.000103577791352203 + 0.000418560847909051i	0.000103577791352204 - 0.000418560847909052i	0.000111855251188162 + 0.000264516809332622i	0.000111855251188162 - 0.000264516809332622i	0.000116563572343964 + 0.000125404520538624i	0.000116563572343964 - 0.000125404520538624i	0.000118209020633239 + 1.91357681218721e-19i	6.62013026565563e-05 - 5.77706237971419e-21i
```

##  Remark  ##
If you use these SOE in your work and feel that these approximations are helpful to you, please cite the following paperï¼š

[A kernel-independent sum-of-exponentials method, Z. Gao, J. Liang and Z. Xu, J. Sci. Comput., 93(2022), Article Number: 40.](https://link.springer.com/article/10.1007/s10915-022-01999-1)

If you require further information, for example, the SOE approximation (or the sum-of-Gaussians approximation) for some other kernels which are not include in this repository, please feel free to contact us. Either English or Chinese can be used.
```
Email address: 1270157606gzx@sjtu.edu.cn, liangjiuyang@sjtu.edu.cn, xuzl@sjtu.edu.cn.
```
